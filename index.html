<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>THREADS'26 Backend Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    form { margin-bottom: 30px; padding: 10px; border: 1px solid #ccc; }
    input, select, textarea { width: 100%; margin: 5px 0; padding: 5px; }
    button { padding: 10px 20px; }
    h2 { color: #2c3e50; }
    pre { background: #f4f4f4; padding: 10px; }
  </style>
</head>
<body>

<h1>THREADS'26 Backend Test</h1>

<!-- 1️⃣ Register Participant + Event Selection -->
<h2>1️⃣ Register Participant</h2>
<form id="registerForm">
  <input type="text" name="full_name" placeholder="Full Name" required>
  <input type="email" name="email" placeholder="Email" required>
  <input type="text" name="phone" placeholder="Phone" required>
  <input type="text" name="college_name" placeholder="College Name">
  <input type="text" name="department" placeholder="Department">
  <input type="text" name="year_of_study" placeholder="Year">
  <input type="text" name="city" placeholder="City">
  <input type="text" name="state" placeholder="State">
  <label>Accommodation Required?</label>
  <select name="accommodation_required">
    <option value="false">No</option>
    <option value="true">Yes</option>
  </select>
  <label>Event IDs (comma separated)</label>
  <input type="text" name="event_ids" placeholder="e.g., 1,2,3">
  <button type="submit">Register</button>
</form>
<pre id="registerResult"></pre>

<!-- 2️⃣ One-Time Payment -->
<h2>2️⃣ One-Time Payment</h2>
<form id="paymentForm">
  <input type="number" name="participant_id" placeholder="Participant ID" required>
  <label>Registration IDs (comma separated)</label>
  <input type="text" name="registration_ids" placeholder="e.g., THREADS26EVENT0001,THREADS26WORKSHOP0002" required>
  <select name="payment_method">
    <option value="UPI">UPI</option>
    <option value="Card">Card</option>
    <option value="NetBanking">NetBanking</option>
  </select>
  <input type="number" step="0.01" name="amount" placeholder="Total Amount" required>
  <button type="submit">Submit Payment</button>
</form>
<pre id="paymentResult"></pre>

<!-- 3️⃣ Gallery Upload -->
<h2>3️⃣ Upload Gallery Image</h2>
<form id="galleryForm">
  <input type="text" name="album_name" placeholder="Album Name" required>
  <input type="text" name="image_url" placeholder="Image URL" required>
  <button type="submit">Upload</button>
</form>
<pre id="galleryResult"></pre>

<!-- 4️⃣ Fetch Events -->
<h2>4️⃣ Fetch Events</h2>


<button id="fetchEvents">Fetch Events</button>
<pre id="eventsResult"></pre>

<script>
const API_URL = 'https://vimalraj45.github.io/threads26';

// 1️⃣ Register Participant
document.getElementById('registerForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const form = e.target;
  const event_ids = form.event_ids.value.split(',').map(x => parseInt(x.trim()));
  const body = {
    full_name: form.full_name.value,
    email: form.email.value,
    phone: form.phone.value,
    college_name: form.college_name.value,
    department: form.department.value,
    year_of_study: form.year_of_study.value,
    city: form.city.value,
    state: form.state.value,
    accommodation_required: form.accommodation_required.value === 'true',
    event_ids
  };
  const res = await fetch(`${API_URL}/register`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  });
  const data = await res.json();
  document.getElementById('registerResult').textContent = JSON.stringify(data, null, 2);
});

// 2️⃣ One-Time Payment
document.getElementById('paymentForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const form = e.target;
  const registration_ids = form.registration_ids.value.split(',').map(x => x.trim());
  const body = {
    participant_id: parseInt(form.participant_id.value),
    payment_method: form.payment_method.value,
    amount: parseFloat(form.amount.value),
    registration_ids
  };
  const res = await fetch(`${API_URL}/payment`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  });
  const data = await res.json();
  document.getElementById('paymentResult').textContent = JSON.stringify(data, null, 2);
});

// 3️⃣ Gallery Upload
document.getElementById('galleryForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const form = e.target;
  const body = {
    album_name: form.album_name.value,
    image_url: form.image_url.value
  };
  const res = await fetch(`${API_URL}/gallery`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(body)
  });
  const data = await res.json();
  document.getElementById('galleryResult').textContent = JSON.stringify(data, null, 2);
});

// 4️⃣ Fetch Events
document.getElementById('fetchEvents').addEventListener('click', async () => {
  const res = await fetch(`${API_URL}/events`);
  const data = await res.json();
  document.getElementById('eventsResult').textContent = JSON.stringify(data, null, 2);
});
</script>

</body>
</html>
